<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Prediksi Risiko Penyakit Jantung</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
/* =====================
   BACKGROUND
===================== */
body {
    background: rgba(255,182,193,0.9);
    min-height: 100vh;
    font-family: 'Segoe UI', sans-serif;
    overflow-x: hidden;
}

/* =====================
   CARD
===================== */
.card {
    border-radius: 25px;
    background: rgba(255,255,255,0.95);
}

/* =====================
   HEARTBEAT ANIMATION
===================== */
@keyframes heartbeat {
    0%   { transform: scale(1); }
    14%  { transform: scale(1.1); }
    28%  { transform: scale(1); }
    42%  { transform: scale(1.15); }
    70%  { transform: scale(1); }
}

/* =====================
   TITLE
===================== */
.title-heart {
    animation: heartbeat 1.6s infinite;
    color: #ff3f94;
}

/* =====================
   BUTTON
===================== */
.btn-pink {
    background: linear-gradient(135deg, #ff5fa2, #ff85c1);
    border: none;
    color: white;
    font-weight: bold;
}

.btn-pink:hover {
    background: linear-gradient(135deg, #ff3f94, #ff6fb1);
}

/* =====================
   LOADING
===================== */
.loading { display: none; }
.spinner-border { color: #ff5fa2; }

/* =====================
   RESULT
===================== */
#result {
    font-weight: bold;
    font-size: 1.3rem;
}

/* =====================
   FLOATING HEARTS
===================== */
.heart {
    position: fixed;
    bottom: -100px;
    opacity: 0.35;
    animation: floatUp linear infinite, heartbeat 2.2s infinite;
    pointer-events: none;
    z-index: 1;
}


@keyframes floatUp {
    from {
        transform: translateY(0) scale(0.8);
        opacity: 0;
    }
    10% { opacity: 0.4; }
    to {
        transform: translateY(-120vh) scale(1.4);
        opacity: 0;
    }
}
</style>
</head>

<body>

<div class="container mt-5 mb-5">
    <div class="card shadow-lg">
        <div class="card-body p-4">

            <h3 class="text-center mb-4 title-heart">
                üíó Prediksi Risiko Penyakit Jantung
            </h3>

            <div class="row g-3">

                <div class="col-md-6">
                    <label class="form-label">Umur</label>
                    <input type="number" id="age" class="form-control">
                </div>

                <div class="col-md-6">
                    <label class="form-label">Jenis Kelamin</label>
                    <select id="sex" class="form-select">
                        <option value="M">Laki-laki</option>
                        <option value="F">Perempuan</option>
                    </select>
                </div>

                <div class="col-md-6">
                    <label class="form-label">Tipe Nyeri Dada</label>
                    <select id="cp" class="form-select">
                        <option value="ATA">Atypical Angina</option>
                        <option value="NAP">Non-Anginal Pain</option>
                        <option value="ASY">Tanpa Gejala</option>
                        <option value="TA">Typical Angina</option>
                    </select>
                </div>

                <div class="col-md-6">
                    <label class="form-label">Tekanan Darah</label>
                    <input type="number" id="bp" class="form-control" value="120">
                </div>

                <div class="col-md-6">
                    <label class="form-label">Kolesterol</label>
                    <input type="number" id="chol" class="form-control" value="200">
                </div>

                <div class="col-md-6">
                    <label class="form-label">Gula Darah</label>
                    <select id="fbs" class="form-select">
                        <option value="0">Normal</option>
                        <option value="1">Tinggi</option>
                    </select>
                </div>

                <div class="col-md-6">
                    <label class="form-label">Detak Maks</label>
                    <input type="number" id="maxhr" class="form-control" value="150">
                </div>

                <div class="col-md-6">
                    <label class="form-label">Nyeri Saat Olahraga</label>
                    <select id="angina" class="form-select">
                        <option value="N">Tidak</option>
                        <option value="Y">Ya</option>
                    </select>
                </div>
            </div>

            <div class="d-grid mt-4">
                <button class="btn btn-pink btn-lg" onclick="predict()">üíó Prediksi</button>
            </div>

            <div class="loading mt-3 text-center" id="loading">
                <div class="spinner-border"></div>
                <p class="mt-2 text-muted">Sedang memproses...</p>
            </div>

            <h4 class="text-center mt-4" id="result"></h4>

        </div>
    </div>
</div>

<script>
/* =========================
   FLOATING HEART GENERATOR
========================= */
const heartCount = 22;

for (let i = 0; i < heartCount; i++) {
    const heart = document.createElement("div");
    heart.innerHTML = `<svg width="50" height="50" viewBox="0 0 50 50" fill="#ff5fa2" xmlns="http://www.w3.org/2000/svg">
        <path d="M25,45 C12,35 5,28 5,20 C5,12 10,7 15,7 C18,7 21,9 25,12 C29,9 32,7 35,7 C40,7 45,12 45,20 C45,28 38,35 25,45 Z" />
    </svg>`;
    
    heart.className = "heart";
    heart.style.left = Math.random() * 100 + "vw";
    heart.style.width = 25 + Math.random() * 50 + "px";
    heart.style.animationDuration = 12 + Math.random() * 14 + "s";
    heart.style.animationDelay = Math.random() * 6 + "s";

    document.body.appendChild(heart);
}

/* =========================
   PREDICTION (ASLI)
========================= */
async function predict() {

    if (age.value === "") {
        alert("‚ö†Ô∏è Umur wajib diisi!");
        return;
    }

    document.getElementById("loading").style.display = "block";
    document.getElementById("result").innerText = "";

    const data = {
        Age: parseInt(age.value),
        Sex: sex.value,
        ChestPainType: cp.value,
        RestingBP: parseInt(bp.value),
        Cholesterol: parseInt(chol.value),
        FastingBS: parseInt(fbs.value),
        MaxHR: parseInt(maxhr.value),
        ExerciseAngina: angina.value
    };

    try {
        const response = await fetch("http://127.0.0.1:8000/predict", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        });

        const result = await response.json();

        document.getElementById("result").innerText =
            result.heart_disease_prediction === 1
            ? "‚ö†Ô∏è Berisiko Penyakit Jantung"
            : "‚úÖ Tidak Berisiko Penyakit Jantung";

    } catch (error) {
        alert("‚ùå Gagal terhubung ke server. Pastikan server FastAPI sudah berjalan.");
    }

    document.getElementById("loading").style.display = "none";
}
</script>

</body>
</html>
